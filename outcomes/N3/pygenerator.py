import slye_math as sm
import math
import random


def generate(**kwargs):
    force_listing = False
    if kwargs['n3_n4_force_listing_method']:
        force_listing = True
    # Part (a): Listing method

    # Created dictionary ahead of time using gen_divisors.py
    # Dict skips primes, integers with too many divisors (>8), and integers with prime divisors >=17
    # Dict lists out available multiples and how much is shared with other integers (after the filtering)
    # Note that len's values have ints, while the remaining values are str
    # For some reason I forgot that dictionaries could have integers as keys, so that's why we are string-based
    gcd_listing_dict = {
        '4': {'divisors_list': ['1', '2', '4'],
              'len': 3,
              'available_multiples': ['8', '12', '16', '20', '24', '28', '32', '40', '44', '52', '56', '64', '68',
                                      '76', '88', '92'],
              'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                  '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
              'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '34', '38', '42', '46', '50', '54',
                                    '58', '62', '66', '70', '74', '78', '82', '86', '94', '98'],
              'shares_smaller_composite': None},
        '6': {'divisors_list': ['1', '2', '3', '6'],
              'len': 4,
              'available_multiples': ['12', '18', '24', '30', '42', '54', '66', '78'],
              'relative_primes': ['25', '35', '49', '55', '65', '77', '85', '91', '95'],
              'shares_prime_only': ['4', '8', '9', '10', '14', '15', '16', '20', '21', '22', '26', '27', '28',
                                    '32', '33', '34', '38', '39', '40', '44', '45', '46', '50', '51', '52', '56',
                                    '57', '58', '62', '63', '64', '68', '69', '70', '74', '75', '76', '81', '82',
                                    '86', '87', '88', '92', '93', '94', '98', '99'],
              'shares_smaller_composite': None},
        '8': {'divisors_list': ['1', '2', '4', '8'],
              'len': 4,
              'available_multiples': ['16', '24', '32', '40', '56', '64', '88'],
              'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                  '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
              'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '34', '38', '42', '46', '50', '54',
                                    '58', '62', '66', '70', '74', '78', '82', '86', '94', '98'],
              'shares_smaller_composite': ['12', '20', '28', '44', '52', '68', '76', '92']},
        '9': {'divisors_list': ['1', '3', '9'],
              'len': 3,
              'available_multiples': ['18', '27', '45', '54', '63', '81', '99'],
              'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '34', '35', '38',
                                  '40', '44', '46', '49', '50', '52', '55', '56', '58', '62', '64', '65', '68',
                                  '70', '74', '76', '77', '82', '85', '86', '88', '91', '92', '94', '95', '98'],
              'shares_prime_only': ['6', '12', '15', '21', '24', '30', '33', '39', '42', '51', '57', '66', '69',
                                    '75', '78', '87', '93'],
              'shares_smaller_composite': None},
        '10': {'divisors_list': ['1', '2', '5', '10'],
               'len': 4,
               'available_multiples': ['20', '30', '40', '50', '70'],
               'relative_primes': ['9', '21', '27', '33', '39', '49', '51', '57', '63', '69', '77', '81', '87',
                                   '91', '93', '99'],
               'shares_prime_only': ['4', '6', '8', '12', '14', '15', '16', '18', '22', '24', '25', '26', '28',
                                     '32', '34', '35', '38', '42', '44', '45', '46', '52', '54', '55', '56', '58',
                                     '62', '64', '65', '66', '68', '74', '75', '76', '78', '82', '85', '86', '88',
                                     '92', '94', '95', '98'],
               'shares_smaller_composite': None},
        '12': {'divisors_list': ['1', '2', '3', '4', '6', '12'],
               'len': 6,
               'available_multiples': ['24'],
               'relative_primes': ['25', '35', '49', '55', '65', '77', '85', '91', '95'],
               'shares_prime_only': ['9', '10', '14', '15', '21', '22', '26', '27', '33', '34', '38', '39', '45',
                                     '46', '50', '51', '57', '58', '62', '63', '69', '70', '74', '75', '81', '82',
                                     '86', '87', '93', '94', '98', '99'],
               'shares_smaller_composite': ['8', '16', '18', '20', '28', '30', '32', '40', '42', '44', '52', '54',
                                            '56', '64', '66', '68', '76', '78', '88', '92']},
        '14': {'divisors_list': ['1', '2', '7', '14'],
               'len': 4,
               'available_multiples': ['28', '42', '56', '70', '98'],
               'relative_primes': ['9', '15', '25', '27', '33', '39', '45', '51', '55', '57', '65', '69', '75',
                                   '81', '85', '87', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '16', '18', '20', '21', '22', '24', '26', '30',
                                     '32', '34', '35', '38', '40', '44', '46', '49', '50', '52', '54', '58', '62',
                                     '63', '64', '66', '68', '74', '76', '77', '78', '82', '86', '88', '91', '92',
                                     '94'],
               'shares_smaller_composite': None},
        '15': {'divisors_list': ['1', '3', '5', '15'],
               'len': 4,
               'available_multiples': ['30', '45', '75'],
               'relative_primes': ['4', '8', '14', '16', '22', '26', '28', '32', '34', '38', '44', '46', '49',
                                   '52', '56', '58', '62', '64', '68', '74', '76', '77', '82', '86', '88', '91',
                                   '92', '94', '98'],
               'shares_prime_only': ['6', '9', '10', '12', '18', '20', '21', '24', '25', '27', '33', '35', '39',
                                     '40', '42', '50', '51', '54', '55', '57', '63', '65', '66', '69', '70', '78',
                                     '81', '85', '87', '93', '95', '99'],
               'shares_smaller_composite': None},
        '16': {'divisors_list': ['1', '2', '4', '8', '16'],
               'len': 5,
               'available_multiples': ['32', '64'],
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '34', '38', '42', '46', '50', '54',
                                     '58', '62', '66', '70', '74', '78', '82', '86', '94', '98'],
               'shares_smaller_composite': ['12', '20', '24', '28', '40', '44', '52', '56', '68', '76', '88',
                                            '92']},
        '18': {'divisors_list': ['1', '2', '3', '6', '9', '18'],
               'len': 6,
               'available_multiples': ['54'],
               'relative_primes': ['25', '35', '49', '55', '65', '77', '85', '91', '95'],
               'shares_prime_only': ['4', '8', '10', '14', '15', '16', '20', '21', '22', '26', '28', '32', '33',
                                     '34', '38', '39', '40', '44', '46', '50', '51', '52', '56', '57', '58', '62',
                                     '64', '68', '69', '70', '74', '75', '76', '82', '86', '87', '88', '92', '93',
                                     '94', '98'],
               'shares_smaller_composite': ['12', '24', '27', '30', '42', '45', '63', '66', '78', '81', '99']},
        '20': {'divisors_list': ['1', '2', '4', '5', '10', '20'],
               'len': 6,
               'available_multiples': ['40'],
               'relative_primes': ['9', '21', '27', '33', '39', '49', '51', '57', '63', '69', '77', '81', '87',
                                   '91', '93', '99'],
               'shares_prime_only': ['6', '14', '15', '18', '22', '25', '26', '34', '35', '38', '42', '45', '46',
                                     '54', '55', '58', '62', '65', '66', '74', '75', '78', '82', '85', '86', '94',
                                     '95', '98'],
               'shares_smaller_composite': ['8', '12', '16', '24', '28', '30', '32', '44', '50', '52', '56', '64',
                                            '68', '70', '76', '88', '92']},
        '21': {'divisors_list': ['1', '3', '7', '21'],
               'len': 4,
               'available_multiples': ['42', '63'],
               'relative_primes': ['4', '8', '10', '16', '20', '22', '25', '26', '32', '34', '38', '40', '44',
                                   '46', '50', '52', '55', '58', '62', '64', '65', '68', '74', '76', '82', '85',
                                   '86', '88', '92', '94', '95'],
               'shares_prime_only': ['6', '9', '12', '14', '15', '18', '24', '27', '28', '30', '33', '35', '39',
                                     '45', '49', '51', '54', '56', '57', '66', '69', '70', '75', '77', '78', '81',
                                     '87', '91', '93', '98', '99'],
               'shares_smaller_composite': None},
        '22': {'divisors_list': ['1', '2', '11', '22'],
               'len': 4,
               'available_multiples': ['44', '66', '88'],
               'relative_primes': ['9', '15', '21', '25', '27', '35', '39', '45', '49', '51', '57', '63', '65',
                                   '69', '75', '81', '85', '87', '91', '93', '95'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '24', '26', '28', '30',
                                     '32', '33', '34', '38', '40', '42', '46', '50', '52', '54', '55', '56', '58',
                                     '62', '64', '68', '70', '74', '76', '77', '78', '82', '86', '92', '94', '98',
                                     '99'],
               'shares_smaller_composite': None},
        '24': {'divisors_list': ['1', '2', '3', '4', '6', '8', '12', '24'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['25', '35', '49', '55', '65', '77', '85', '91', '95'],
               'shares_prime_only': ['9', '10', '14', '15', '21', '22', '26', '27', '33', '34', '38', '39', '45',
                                     '46', '50', '51', '57', '58', '62', '63', '69', '70', '74', '75', '81', '82',
                                     '86', '87', '93', '94', '98', '99'],
               'shares_smaller_composite': ['16', '18', '20', '28', '30', '32', '40', '42', '44', '52', '54', '56',
                                            '64', '66', '68', '76', '78', '88', '92']},
        '25': {'divisors_list': ['1', '5', '25'],
               'len': 3,
               'available_multiples': ['50', '75'],
               'relative_primes': ['4', '6', '8', '9', '12', '14', '16', '18', '21', '22', '24', '26', '27', '28',
                                   '32', '33', '34', '38', '39', '42', '44', '46', '49', '51', '52', '54', '56',
                                   '57', '58', '62', '63', '64', '66', '68', '69', '74', '76', '77', '78', '81',
                                   '82', '86', '87', '88', '91', '92', '93', '94', '98', '99'],
               'shares_prime_only': ['10', '15', '20', '30', '35', '40', '45', '55', '65', '70', '85', '95'],
               'shares_smaller_composite': None},
        '26': {'divisors_list': ['1', '2', '13', '26'],
               'len': 4,
               'available_multiples': ['52', '78'],
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '45', '49', '51', '55', '57', '63',
                                   '69', '75', '77', '81', '85', '87', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '28', '30',
                                     '32', '34', '38', '39', '40', '42', '44', '46', '50', '54', '56', '58', '62',
                                     '64', '65', '66', '68', '70', '74', '76', '82', '86', '88', '91', '92', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '27': {'divisors_list': ['1', '3', '9', '27'],
               'len': 4,
               'available_multiples': ['54', '81'],
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '34', '35',
                                   '38', '40', '44', '46', '49', '50', '52', '55', '56', '58', '62', '64', '65',
                                   '68', '70', '74', '76', '77', '82', '85', '86', '88', '91', '92', '94', '95',
                                   '98'],
               'shares_prime_only': ['6', '12', '15', '21', '24', '30', '33', '39', '42', '51', '57', '66', '69',
                                     '75', '78', '87', '93'],
               'shares_smaller_composite': ['18', '45', '63', '99']},
        '28': {'divisors_list': ['1', '2', '4', '7', '14', '28'],
               'len': 6,
               'available_multiples': ['56'],
               'relative_primes': ['9', '15', '25', '27', '33', '39', '45', '51', '55', '57', '65', '69', '75',
                                   '81', '85', '87', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '18', '21', '22', '26', '30', '34', '35', '38', '46', '49', '50',
                                     '54', '58', '62', '63', '66', '74', '77', '78', '82', '86', '91', '94'],
               'shares_smaller_composite': ['8', '12', '16', '20', '24', '32', '40', '42', '44', '52', '64', '68',
                                            '70', '76', '88', '92', '98']},
        '30': {'divisors_list': ['1', '2', '3', '5', '6', '10', '15', '30'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['49', '77', '91'],
               'shares_prime_only': ['4', '8', '9', '14', '16', '21', '22', '25', '26', '27', '28', '32', '33',
                                     '34', '35', '38', '39', '44', '46', '51', '52', '55', '56', '57', '58', '62',
                                     '63', '64', '65', '68', '69', '74', '76', '81', '82', '85', '86', '87', '88',
                                     '92', '93', '94', '95', '98', '99'],
               'shares_smaller_composite': ['12', '18', '20', '24', '40', '42', '45', '50', '54', '66', '70', '75',
                                            '78']},
        '32': {'divisors_list': ['1', '2', '4', '8', '16', '32'],
               'len': 6,
               'available_multiples': ['64'],
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '34', '38', '42', '46', '50', '54',
                                     '58', '62', '66', '70', '74', '78', '82', '86', '94', '98'],
               'shares_smaller_composite': ['12', '20', '24', '28', '40', '44', '52', '56', '68', '76', '88',
                                            '92']},
        '33': {'divisors_list': ['1', '3', '11', '33'],
               'len': 4,
               'available_multiples': ['66', '99'],
               'relative_primes': ['4', '8', '10', '14', '16', '20', '25', '26', '28', '32', '34', '35', '38',
                                   '40', '46', '49', '50', '52', '56', '58', '62', '64', '65', '68', '70', '74',
                                   '76', '82', '85', '86', '91', '92', '94', '95', '98'],
               'shares_prime_only': ['6', '9', '12', '15', '18', '21', '22', '24', '27', '30', '39', '42', '44',
                                     '45', '51', '54', '55', '57', '63', '69', '75', '77', '78', '81', '87', '88',
                                     '93'],
               'shares_smaller_composite': None},
        '34': {'divisors_list': ['1', '2', '17', '34'],
               'len': 4,
               'available_multiples': ['68'],
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '55', '57', '63',
                                   '65', '69', '75', '77', '81', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '38', '40', '42', '44', '46', '50', '51', '52', '54', '56', '58',
                                     '62', '64', '66', '70', '74', '76', '78', '82', '85', '86', '88', '92', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '35': {'divisors_list': ['1', '5', '7', '35'],
               'len': 4,
               'available_multiples': ['70'],
               'relative_primes': ['4', '6', '8', '9', '12', '16', '18', '22', '24', '26', '27', '32', '33', '34',
                                   '38', '39', '44', '46', '51', '52', '54', '57', '58', '62', '64', '66', '68',
                                   '69', '74', '76', '78', '81', '82', '86', '87', '88', '92', '93', '94', '99'],
               'shares_prime_only': ['10', '14', '15', '20', '21', '25', '28', '30', '40', '42', '45', '49', '50',
                                     '55', '56', '63', '65', '75', '77', '85', '91', '95', '98'],
               'shares_smaller_composite': None},
        '38': {'divisors_list': ['1', '2', '19', '38'],
               'len': 4,
               'available_multiples': ['76'],
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '63',
                                   '65', '69', '75', '77', '81', '85', '87', '91', '93', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '40', '42', '44', '46', '50', '52', '54', '56', '57', '58',
                                     '62', '64', '66', '68', '70', '74', '78', '82', '86', '88', '92', '94', '95',
                                     '98'],
               'shares_smaller_composite': None},
        '39': {'divisors_list': ['1', '3', '13', '39'],
               'len': 4,
               'available_multiples': ['78'],
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '28', '32', '34', '35', '38',
                                   '40', '44', '46', '49', '50', '55', '56', '58', '62', '64', '68', '70', '74',
                                   '76', '77', '82', '85', '86', '88', '92', '94', '95', '98'],
               'shares_prime_only': ['6', '9', '12', '15', '18', '21', '24', '26', '27', '30', '33', '42', '45',
                                     '51', '52', '54', '57', '63', '65', '66', '69', '75', '81', '87', '91', '93',
                                     '99'],
               'shares_smaller_composite': None},
        '40': {'divisors_list': ['1', '2', '4', '5', '8', '10', '20', '40'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['9', '21', '27', '33', '39', '49', '51', '57', '63', '69', '77', '81', '87',
                                   '91', '93', '99'],
               'shares_prime_only': ['6', '14', '15', '18', '22', '25', '26', '34', '35', '38', '42', '45', '46',
                                     '54', '55', '58', '62', '65', '66', '74', '75', '78', '82', '85', '86', '94',
                                     '95', '98'],
               'shares_smaller_composite': ['12', '16', '24', '28', '30', '32', '44', '50', '52', '56', '64', '68',
                                            '70', '76', '88', '92']},
        '42': {'divisors_list': ['1', '2', '3', '6', '7', '14', '21', '42'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['25', '55', '65', '85', '95'],
               'shares_prime_only': ['4', '8', '9', '10', '15', '16', '20', '22', '26', '27', '32', '33', '34',
                                     '35', '38', '39', '40', '44', '45', '46', '49', '50', '51', '52', '57', '58',
                                     '62', '64', '68', '69', '74', '75', '76', '77', '81', '82', '86', '87', '88',
                                     '91', '92', '93', '94', '99'],
               'shares_smaller_composite': ['12', '18', '24', '28', '30', '54', '56', '63', '66', '70', '78',
                                            '98']},
        '44': {'divisors_list': ['1', '2', '4', '11', '22', '44'],
               'len': 6,
               'available_multiples': ['88'],
               'relative_primes': ['9', '15', '21', '25', '27', '35', '39', '45', '49', '51', '57', '63', '65',
                                   '69', '75', '81', '85', '87', '91', '93', '95'],
               'shares_prime_only': ['6', '10', '14', '18', '26', '30', '33', '34', '38', '42', '46', '50', '54',
                                     '55', '58', '62', '70', '74', '77', '78', '82', '86', '94', '98', '99'],
               'shares_smaller_composite': ['8', '12', '16', '20', '24', '28', '32', '40', '52', '56', '64', '66',
                                            '68', '76', '92']},
        '45': {'divisors_list': ['1', '3', '5', '9', '15', '45'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['4', '8', '14', '16', '22', '26', '28', '32', '34', '38', '44', '46', '49',
                                   '52', '56', '58', '62', '64', '68', '74', '76', '77', '82', '86', '88', '91',
                                   '92', '94', '98'],
               'shares_prime_only': ['6', '10', '12', '20', '21', '24', '25', '33', '35', '39', '40', '42', '50',
                                     '51', '55', '57', '65', '66', '69', '70', '78', '85', '87', '93', '95'],
               'shares_smaller_composite': ['18', '27', '30', '54', '63', '75', '81', '99']},
        '46': {'divisors_list': ['1', '2', '23', '46'],
               'len': 4,
               'available_multiples': ['92'],
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '38', '40', '42', '44', '50', '52', '54', '56', '58', '62',
                                     '64', '66', '68', '69', '70', '74', '76', '78', '82', '86', '88', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '49': {'divisors_list': ['1', '7', '49'],
               'len': 3,
               'available_multiples': ['98'],
               'relative_primes': ['4', '6', '8', '9', '10', '12', '15', '16', '18', '20', '22', '24', '25', '26',
                                   '27', '30', '32', '33', '34', '38', '39', '40', '44', '45', '46', '50', '51',
                                   '52', '54', '55', '57', '58', '62', '64', '65', '66', '68', '69', '74', '75',
                                   '76', '78', '81', '82', '85', '86', '87', '88', '92', '93', '94', '95', '99'],
               'shares_prime_only': ['14', '21', '28', '35', '42', '56', '63', '70', '77', '91'],
               'shares_smaller_composite': None},
        '50': {'divisors_list': ['1', '2', '5', '10', '25', '50'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['9', '21', '27', '33', '39', '49', '51', '57', '63', '69', '77', '81', '87',
                                   '91', '93', '99'],
               'shares_prime_only': ['4', '6', '8', '12', '14', '15', '16', '18', '22', '24', '26', '28', '32',
                                     '34', '35', '38', '42', '44', '45', '46', '52', '54', '55', '56', '58', '62',
                                     '64', '65', '66', '68', '74', '76', '78', '82', '85', '86', '88', '92', '94',
                                     '95', '98'],
               'shares_smaller_composite': ['20', '30', '40', '70', '75']},
        '51': {'divisors_list': ['1', '3', '17', '51'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '35', '38',
                                   '40', '44', '46', '49', '50', '52', '55', '56', '58', '62', '64', '65', '70',
                                   '74', '76', '77', '82', '86', '88', '91', '92', '94', '95', '98'],
               'shares_prime_only': ['6', '9', '12', '15', '18', '21', '24', '27', '30', '33', '34', '39', '42',
                                     '45', '54', '57', '63', '66', '68', '69', '75', '78', '81', '85', '87', '93',
                                     '99'],
               'shares_smaller_composite': None},
        '52': {'divisors_list': ['1', '2', '4', '13', '26', '52'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '45', '49', '51', '55', '57', '63',
                                   '69', '75', '77', '81', '85', '87', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '14', '18', '22', '30', '34', '38', '39', '42', '46', '50', '54',
                                     '58', '62', '65', '66', '70', '74', '82', '86', '91', '94', '98'],
               'shares_smaller_composite': ['8', '12', '16', '20', '24', '28', '32', '40', '44', '56', '64', '68',
                                            '76', '78', '88', '92']},
        '54': {'divisors_list': ['1', '2', '3', '6', '9', '18', '27', '54'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['25', '35', '49', '55', '65', '77', '85', '91', '95'],
               'shares_prime_only': ['4', '8', '10', '14', '15', '16', '20', '21', '22', '26', '28', '32', '33',
                                     '34', '38', '39', '40', '44', '46', '50', '51', '52', '56', '57', '58', '62',
                                     '64', '68', '69', '70', '74', '75', '76', '82', '86', '87', '88', '92', '93',
                                     '94', '98'],
               'shares_smaller_composite': ['12', '24', '30', '42', '45', '63', '66', '78', '81', '99']},
        '55': {'divisors_list': ['1', '5', '11', '55'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '6', '8', '9', '12', '14', '16', '18', '21', '24', '26', '27', '28', '32',
                                   '34', '38', '39', '42', '46', '49', '51', '52', '54', '56', '57', '58', '62',
                                   '63', '64', '68', '69', '74', '76', '78', '81', '82', '86', '87', '91', '92',
                                   '93', '94', '98'],
               'shares_prime_only': ['10', '15', '20', '22', '25', '30', '33', '35', '40', '44', '45', '50', '65',
                                     '66', '70', '75', '77', '85', '88', '95', '99'],
               'shares_smaller_composite': None},
        '56': {'divisors_list': ['1', '2', '4', '7', '8', '14', '28', '56'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['9', '15', '25', '27', '33', '39', '45', '51', '55', '57', '65', '69', '75',
                                   '81', '85', '87', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '18', '21', '22', '26', '30', '34', '35', '38', '46', '49', '50',
                                     '54', '58', '62', '63', '66', '74', '77', '78', '82', '86', '91', '94'],
               'shares_smaller_composite': ['12', '16', '20', '24', '32', '40', '42', '44', '52', '64', '68', '70',
                                            '76', '88', '92', '98']},
        '57': {'divisors_list': ['1', '3', '19', '57'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '34', '35',
                                   '40', '44', '46', '49', '50', '52', '55', '56', '58', '62', '64', '65', '68',
                                   '70', '74', '77', '82', '85', '86', '88', '91', '92', '94', '98'],
               'shares_prime_only': ['6', '9', '12', '15', '18', '21', '24', '27', '30', '33', '38', '39', '42',
                                     '45', '51', '54', '63', '66', '69', '75', '76', '78', '81', '87', '93', '95',
                                     '99'],
               'shares_smaller_composite': None},
        '58': {'divisors_list': ['1', '2', '29', '58'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '91', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '38', '40', '42', '44', '46', '50', '52', '54', '56', '62',
                                     '64', '66', '68', '70', '74', '76', '78', '82', '86', '87', '88', '92', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '62': {'divisors_list': ['1', '2', '31', '62'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '38', '40', '42', '44', '46', '50', '52', '54', '56', '58',
                                     '64', '66', '68', '70', '74', '76', '78', '82', '86', '88', '92', '93', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '63': {'divisors_list': ['1', '3', '7', '9', '21', '63'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '16', '20', '22', '25', '26', '32', '34', '38', '40', '44',
                                   '46', '50', '52', '55', '58', '62', '64', '65', '68', '74', '76', '82', '85',
                                   '86', '88', '92', '94', '95'],
               'shares_prime_only': ['6', '12', '14', '15', '24', '28', '30', '33', '35', '39', '49', '51', '56',
                                     '57', '66', '69', '70', '75', '77', '78', '87', '91', '93', '98'],
               'shares_smaller_composite': ['18', '27', '42', '45', '54', '81', '99']},
        '64': {'divisors_list': ['1', '2', '4', '8', '16', '32', '64'],
               'len': 7,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '34', '38', '42', '46', '50', '54',
                                     '58', '62', '66', '70', '74', '78', '82', '86', '94', '98'],
               'shares_smaller_composite': ['12', '20', '24', '28', '40', '44', '52', '56', '68', '76', '88',
                                            '92']},
        '65': {'divisors_list': ['1', '5', '13', '65'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '6', '8', '9', '12', '14', '16', '18', '21', '22', '24', '27', '28', '32',
                                   '33', '34', '38', '42', '44', '46', '49', '51', '54', '56', '57', '58', '62',
                                   '63', '64', '66', '68', '69', '74', '76', '77', '81', '82', '86', '87', '88',
                                   '92', '93', '94', '98', '99'],
               'shares_prime_only': ['10', '15', '20', '25', '26', '30', '35', '39', '40', '45', '50', '52', '55',
                                     '70', '75', '78', '85', '91', '95'],
               'shares_smaller_composite': None},
        '66': {'divisors_list': ['1', '2', '3', '6', '11', '22', '33', '66'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['25', '35', '49', '65', '85', '91', '95'],
               'shares_prime_only': ['4', '8', '9', '10', '14', '15', '16', '20', '21', '26', '27', '28', '32',
                                     '34', '38', '39', '40', '45', '46', '50', '51', '52', '55', '56', '57', '58',
                                     '62', '63', '64', '68', '69', '70', '74', '75', '76', '77', '81', '82', '86',
                                     '87', '92', '93', '94', '98'],
               'shares_smaller_composite': ['12', '18', '24', '30', '42', '44', '54', '78', '88', '99']},
        '68': {'divisors_list': ['1', '2', '4', '17', '34', '68'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '55', '57', '63',
                                   '65', '69', '75', '77', '81', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '38', '42', '46', '50', '51', '54',
                                     '58', '62', '66', '70', '74', '78', '82', '85', '86', '94', '98'],
               'shares_smaller_composite': ['8', '12', '16', '20', '24', '28', '32', '40', '44', '52', '56', '64',
                                            '76', '88', '92']},
        '69': {'divisors_list': ['1', '3', '23', '69'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '34', '35',
                                   '38', '40', '44', '49', '50', '52', '55', '56', '58', '62', '64', '65', '68',
                                   '70', '74', '76', '77', '82', '85', '86', '88', '91', '94', '95', '98'],
               'shares_prime_only': ['6', '9', '12', '15', '18', '21', '24', '27', '30', '33', '39', '42', '45',
                                     '46', '51', '54', '57', '63', '66', '75', '78', '81', '87', '92', '93',
                                     '99'],
               'shares_smaller_composite': None},
        '70': {'divisors_list': ['1', '2', '5', '7', '10', '14', '35', '70'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['9', '27', '33', '39', '51', '57', '69', '81', '87', '93', '99'],
               'shares_prime_only': ['4', '6', '8', '12', '15', '16', '18', '21', '22', '24', '25', '26', '32',
                                     '34', '38', '44', '45', '46', '49', '52', '54', '55', '58', '62', '63', '64',
                                     '65', '66', '68', '74', '75', '76', '77', '78', '82', '85', '86', '88', '91',
                                     '92', '94', '95'],
               'shares_smaller_composite': ['20', '28', '30', '40', '42', '50', '56', '98']},
        '74': {'divisors_list': ['1', '2', '37', '74'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '38', '40', '42', '44', '46', '50', '52', '54', '56', '58',
                                     '62', '64', '66', '68', '70', '76', '78', '82', '86', '88', '92', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '75': {'divisors_list': ['1', '3', '5', '15', '25', '75'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['4', '8', '14', '16', '22', '26', '28', '32', '34', '38', '44', '46', '49',
                                   '52', '56', '58', '62', '64', '68', '74', '76', '77', '82', '86', '88', '91',
                                   '92', '94', '98'],
               'shares_prime_only': ['6', '9', '10', '12', '18', '20', '21', '24', '27', '33', '35', '39', '40',
                                     '42', '51', '54', '55', '57', '63', '65', '66', '69', '70', '78', '81', '85',
                                     '87', '93', '95', '99'],
               'shares_smaller_composite': ['30', '45', '50']},
        '76': {'divisors_list': ['1', '2', '4', '19', '38', '76'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '63',
                                   '65', '69', '75', '77', '81', '85', '87', '91', '93', '99'],
               'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '34', '42', '46', '50', '54', '57',
                                     '58', '62', '66', '70', '74', '78', '82', '86', '94', '95', '98'],
               'shares_smaller_composite': ['8', '12', '16', '20', '24', '28', '32', '40', '44', '52', '56', '64',
                                            '68', '88', '92']},
        '77': {'divisors_list': ['1', '7', '11', '77'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '6', '8', '9', '10', '12', '15', '16', '18', '20', '24', '25', '26', '27',
                                   '30', '32', '34', '38', '39', '40', '45', '46', '50', '51', '52', '54', '57',
                                   '58', '62', '64', '65', '68', '69', '74', '75', '76', '78', '81', '82', '85',
                                   '86', '87', '92', '93', '94', '95'],
               'shares_prime_only': ['14', '21', '22', '28', '33', '35', '42', '44', '49', '55', '56', '63', '66',
                                     '70', '88', '91', '98', '99'],
               'shares_smaller_composite': None},
        '78': {'divisors_list': ['1', '2', '3', '6', '13', '26', '39', '78'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['25', '35', '49', '55', '77', '85', '95'],
               'shares_prime_only': ['4', '8', '9', '10', '14', '15', '16', '20', '21', '22', '27', '28', '32',
                                     '33', '34', '38', '40', '44', '45', '46', '50', '51', '56', '57', '58', '62',
                                     '63', '64', '65', '68', '69', '70', '74', '75', '76', '81', '82', '86', '87',
                                     '88', '91', '92', '93', '94', '98', '99'],
               'shares_smaller_composite': ['12', '18', '24', '30', '42', '52', '54', '66']},
        '81': {'divisors_list': ['1', '3', '9', '27', '81'],
               'len': 5,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '34', '35',
                                   '38', '40', '44', '46', '49', '50', '52', '55', '56', '58', '62', '64', '65',
                                   '68', '70', '74', '76', '77', '82', '85', '86', '88', '91', '92', '94', '95',
                                   '98'],
               'shares_prime_only': ['6', '12', '15', '21', '24', '30', '33', '39', '42', '51', '57', '66', '69',
                                     '75', '78', '87', '93'],
               'shares_smaller_composite': ['18', '45', '54', '63', '99']},
        '82': {'divisors_list': ['1', '2', '41', '82'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '38', '40', '42', '44', '46', '50', '52', '54', '56', '58',
                                     '62', '64', '66', '68', '70', '74', '76', '78', '86', '88', '92', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '85': {'divisors_list': ['1', '5', '17', '85'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '6', '8', '9', '12', '14', '16', '18', '21', '22', '24', '26', '27', '28',
                                   '32', '33', '38', '39', '42', '44', '46', '49', '52', '54', '56', '57', '58',
                                   '62', '63', '64', '66', '69', '74', '76', '77', '78', '81', '82', '86', '87',
                                   '88', '91', '92', '93', '94', '98', '99'],
               'shares_prime_only': ['10', '15', '20', '25', '30', '34', '35', '40', '45', '50', '51', '55', '65',
                                     '68', '70', '75', '95'],
               'shares_smaller_composite': None},
        '86': {'divisors_list': ['1', '2', '43', '86'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '38', '40', '42', '44', '46', '50', '52', '54', '56', '58',
                                     '62', '64', '66', '68', '70', '74', '76', '78', '82', '88', '92', '94',
                                     '98'],
               'shares_smaller_composite': None},
        '87': {'divisors_list': ['1', '3', '29', '87'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '34', '35',
                                   '38', '40', '44', '46', '49', '50', '52', '55', '56', '62', '64', '65', '68',
                                   '70', '74', '76', '77', '82', '85', '86', '88', '91', '92', '94', '95', '98'],
               'shares_prime_only': ['6', '9', '12', '15', '18', '21', '24', '27', '30', '33', '39', '42', '45',
                                     '51', '54', '57', '58', '63', '66', '69', '75', '78', '81', '93', '99'],
               'shares_smaller_composite': None},
        '88': {'divisors_list': ['1', '2', '4', '8', '11', '22', '44', '88'],
               'len': 8,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '35', '39', '45', '49', '51', '57', '63', '65',
                                   '69', '75', '81', '85', '87', '91', '93', '95'],
               'shares_prime_only': ['6', '10', '14', '18', '26', '30', '33', '34', '38', '42', '46', '50', '54',
                                     '55', '58', '62', '70', '74', '77', '78', '82', '86', '94', '98', '99'],
               'shares_smaller_composite': ['12', '16', '20', '24', '28', '32', '40', '52', '56', '64', '66', '68',
                                            '76', '92']},
        '91': {'divisors_list': ['1', '7', '13', '91'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '6', '8', '9', '10', '12', '15', '16', '18', '20', '22', '24', '25', '27',
                                   '30', '32', '33', '34', '38', '40', '44', '45', '46', '50', '51', '54', '55',
                                   '57', '58', '62', '64', '66', '68', '69', '74', '75', '76', '81', '82', '85',
                                   '86', '87', '88', '92', '93', '94', '95', '99'],
               'shares_prime_only': ['14', '21', '26', '28', '35', '39', '42', '49', '52', '56', '63', '65', '70',
                                     '77', '78', '98'],
               'shares_smaller_composite': None},
        '92': {'divisors_list': ['1', '2', '4', '23', '46', '92'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['6', '10', '14', '18', '22', '26', '30', '34', '38', '42', '50', '54', '58',
                                     '62', '66', '69', '70', '74', '78', '82', '86', '94', '98'],
               'shares_smaller_composite': ['8', '12', '16', '20', '24', '28', '32', '40', '44', '52', '56', '64',
                                            '68', '76', '88']},
        '93': {'divisors_list': ['1', '3', '31', '93'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '14', '16', '20', '22', '25', '26', '28', '32', '34', '35',
                                   '38', '40', '44', '46', '49', '50', '52', '55', '56', '58', '64', '65', '68',
                                   '70', '74', '76', '77', '82', '85', '86', '88', '91', '92', '94', '95', '98'],
               'shares_prime_only': ['6', '9', '12', '15', '18', '21', '24', '27', '30', '33', '39', '42', '45',
                                     '51', '54', '57', '62', '63', '66', '69', '75', '78', '81', '87', '99'],
               'shares_smaller_composite': None},
        '94': {'divisors_list': ['1', '2', '47', '94'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['9', '15', '21', '25', '27', '33', '35', '39', '45', '49', '51', '55', '57',
                                   '63', '65', '69', '75', '77', '81', '85', '87', '91', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24', '26', '28',
                                     '30', '32', '34', '38', '40', '42', '44', '46', '50', '52', '54', '56', '58',
                                     '62', '64', '66', '68', '70', '74', '76', '78', '82', '86', '88', '92',
                                     '98'],
               'shares_smaller_composite': None},
        '95': {'divisors_list': ['1', '5', '19', '95'],
               'len': 4,
               'available_multiples': None,
               'relative_primes': ['4', '6', '8', '9', '12', '14', '16', '18', '21', '22', '24', '26', '27', '28',
                                   '32', '33', '34', '39', '42', '44', '46', '49', '51', '52', '54', '56', '58',
                                   '62', '63', '64', '66', '68', '69', '74', '77', '78', '81', '82', '86', '87',
                                   '88', '91', '92', '93', '94', '98', '99'],
               'shares_prime_only': ['10', '15', '20', '25', '30', '35', '38', '40', '45', '50', '55', '57', '65',
                                     '70', '75', '76', '85'],
               'shares_smaller_composite': None},
        '98': {'divisors_list': ['1', '2', '7', '14', '49', '98'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['9', '15', '25', '27', '33', '39', '45', '51', '55', '57', '65', '69', '75',
                                   '81', '85', '87', '93', '95', '99'],
               'shares_prime_only': ['4', '6', '8', '10', '12', '16', '18', '20', '21', '22', '24', '26', '30',
                                     '32', '34', '35', '38', '40', '44', '46', '50', '52', '54', '58', '62', '63',
                                     '64', '66', '68', '74', '76', '77', '78', '82', '86', '88', '91', '92',
                                     '94'],
               'shares_smaller_composite': ['28', '42', '56', '70']},
        '99': {'divisors_list': ['1', '3', '9', '11', '33', '99'],
               'len': 6,
               'available_multiples': None,
               'relative_primes': ['4', '8', '10', '14', '16', '20', '25', '26', '28', '32', '34', '35', '38',
                                   '40', '46', '49', '50', '52', '56', '58', '62', '64', '65', '68', '70', '74',
                                   '76', '82', '85', '86', '91', '92', '94', '95', '98'],
               'shares_prime_only': ['6', '12', '15', '21', '22', '24', '30', '39', '42', '44', '51', '55', '57',
                                     '69', '75', '77', '78', '87', '88', '93'],
               'shares_smaller_composite': ['18', '27', '45', '54', '63', '66', '81']}
    }

    listing_gcd_type = random.choices(['relatively prime',
                                       'multiple',
                                       'share prime',
                                       'share composite'],
                                      [0.15, 0.15, 0.20, 0.5],
                                      k=1)[0]

    def get_filtered_a_b(main_gcd_dict, subkey_filter):
        filtered_dict = {k: v for k, v in main_gcd_dict.items() if v[subkey_filter] is not None}
        a = random.choice(list(filtered_dict.keys()))
        b = random.choice(filtered_dict[a][subkey_filter])
        return a, b

    match listing_gcd_type:
        case 'relatively prime':
            a = random.choice(list(gcd_listing_dict.keys()))
            b = random.choice(gcd_listing_dict[a]['relative_primes'])

        case 'multiple':
            a, b = get_filtered_a_b(gcd_listing_dict, 'available_multiples')

        case 'share prime':
            a, b = get_filtered_a_b(gcd_listing_dict, 'shares_prime_only')

        case 'share composite':
            a, b = get_filtered_a_b(gcd_listing_dict, 'shares_smaller_composite')

    listing_a, listing_b = list(map(str, sorted([int(a), int(b)])))

    listing_prob = f'\\text{{GCD}}({listing_a},{listing_b})'

    listing_list_a = f'{", ".join(gcd_listing_dict[listing_a]["divisors_list"])}'
    listing_list_b = f'{", ".join(gcd_listing_dict[listing_b]["divisors_list"])}'

    listing_gcd = math.gcd(int(a), int(b))

    # Part (b): Factorization Method

    primes = [2, 3, 5, 7, 11, 13]
    primes_wts = [0.3, 0.25, 0.2, 0.15, 0.05, 0.05]

    def get_factor(prime_cap=17):
        available_primes = [x for x in primes if x < prime_cap]
        available_primes_wts = primes_wts[:len(available_primes)]
        factor = random.choices(available_primes, available_primes_wts, k=1)[0]
        return factor

    allow_one_prefactored = True
    one_prefactored = False
    factorization_type = 'b not prefactored'

    if allow_one_prefactored is True:
        one_prefactored = random.choice([True, False])

    factorization_list_a = []
    factorization_list_b = []

    kernel = 1
    kernel_size = random.choices([1, 2, 3], [0.2, 0.5, 0.3], k=1)[0]
    kernel_prime_cap = 17 if kernel_size < 3 else 11
    for i in range(kernel_size):
        f = get_factor(prime_cap=kernel_prime_cap)
        kernel = kernel * f
        factorization_list_a.append(f)
        factorization_list_b.append(f)

    a = kernel
    b = kernel
    b_cap = 1000 if one_prefactored is True else 600

    while True:
        f = get_factor()
        if a * f > 600:
            break
        else:
            factorization_list_a.append(f)
            a = a * f

    while True:
        f = get_factor()
        if b * f == a:
            if f == 2:
                break
            else:
                f = get_factor(prime_cap=f)
        if b * f > b_cap:
            break
        else:
            factorization_list_b.append(f)
            b = b * f

    factorization_mult_gcd = ' \\times '.join(
        list(map(str, sm.list_intersect(factorization_list_a, factorization_list_b))))
    factorization_mult_a = ' \\times '.join(list(map(str, sorted(factorization_list_a))))
    factorization_mult_b = ' \\times '.join(list(map(str, sorted(factorization_list_b))))

    if one_prefactored is True:
        factorization_type = 'b prefactored'
        prefactored_b_list = []
        for prime in primes:
            prime_exp = factorization_list_b.count(prime)
            if prime_exp == 1:
                prefactored_b_list.append(f'{prime}')
            if prime_exp > 1:
                prefactored_b_list.append(f'{prime}^{prime_exp}')
        factorization_a = a
        factorization_b = ' \\times '.join(prefactored_b_list)
    else:
        if a > b:
            factorization_a, factorization_b = b, a
            factorization_mult_a, factorization_mult_b = factorization_mult_b, factorization_mult_a
        else:
            factorization_a, factorization_b = a, b

    factorization_type += f', a_b kernel {kernel}'

    factorization_prob = f'\\text{{GCD}}({factorization_a},{factorization_b})'
    factorization_gcd = math.gcd(a, b)

    if force_listing:
        listing_prob_wording = "using the listing method (sometimes called the set intersection method). You must show correct lists and a final answer."
    else:
        listing_prob_wording = "using a method of your choice \\textbf{other than} the prime factorization method. You must show your work before giving the final answer."

    return {
        'listing_a': listing_a,
        'listing_b': listing_b,
        'listing_prob': listing_prob,
        'listing_prob_wording': listing_prob_wording,
        'listing_list_a': listing_list_a,
        'listing_list_b': listing_list_b,
        'listing_gcd': listing_gcd,
        'listing_gcd_type': listing_gcd_type,
        'factorization_a': factorization_a,
        'factorization_b': factorization_b,
        'factorization_prob': factorization_prob,
        'factorization_mult_a': factorization_mult_a,
        'factorization_mult_b': factorization_mult_b,
        'factorization_mult_gcd': factorization_mult_gcd,
        'factorization_gcd': factorization_gcd,
        'factorization_type': factorization_type
    }
